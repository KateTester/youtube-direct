<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Partner Test Page</title>
<script type="text/javascript" src="js/ext/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="js/ytd-embed.js"></script>
<script type="text/javascript">

jQuery(document).ready(function() {
  	
	var assignmentId = getUrlParams().id;
	if (!assignmentId) {
		alert('missing assignment id, please append to end of the URL ?id=assignmentId');
		return;
	}

	//addVideoList(assignmentId); 
  
	var ytd = new Ytd();
	ytd.setAssignmentId(assignmentId);
	ytd.setCallToAction('callToAction');
	ytd.setYtdContainer('ytd');
	ytd.ready();  

	 	
});

function addVideoList(id) {  
  getAllApprovedVideos(id, function(entries) {
		for (var i=0; i<entries.length; i++) {
			var entry = entries[i];
			var id = entry.videoId;
			var title = entry.videoTitle;
			var status = entry.status;
			jQuery('#approvedVideos').append('<b>' + title + '</b><br><br>');
			jQuery('#approvedVideos').append(getVideoHTML(id, 200, 175));
			jQuery('#approvedVideos').append('<br><br>');
		}
	});
}

function getAllApprovedVideos(id, callback) {
	var url = '/ApprovedVideoFeed?id=' + id;
	var ajaxCall = {};
	ajaxCall.cache = false;
	ajaxCall.type = 'GET';
	ajaxCall.url = url;
	ajaxCall.dataType = 'json';
	ajaxCall.success = function(data) {		
		callback(data.entries);
	};	
	jQuery.ajax(ajaxCall);	
}

function getVideoHTML(videoId, width, height) {
	
	width = width || 250;
	height = height || 250;
	
	var youtubeUrl = 'http://www.youtube.com/v/' + videoId;
	
	var html = [];
	html.push('<object width="' + width + '" height="' + height + '">');
	html.push('<param name="movie" value="');
	html.push(youtubeUrl);
	html.push('&hl=en&fs=1&"></param>');
	html.push('<param name="allowFullScreen" value="true"></param>');
	html.push('<param name="allowscriptaccess" value="always"></param>');
	html.push('<embed src="');
	html.push(youtubeUrl);
	html.push('&hl=en&fs=1&" type="application/x-shockwave-flash"');
	html.push(' allowscriptaccess="always" allowfullscreen="true" width="' + width + '" height="' + height + '">');
	html.push('</embed></object>');	
	
	return html.join('');
}  

function getUrlParams() {
  var args = new Object();
  var params = window.location.href.split('?');

  if (params.length > 1) {
    params = params[1];
    var pairs = params.split("&");
    for ( var i = 0; i < pairs.length; i++) {
      var pos = pairs[i].indexOf('=');
      if (pos == -1)
        continue;
      var argname = pairs[i].substring(0, pos);
      var value = pairs[i].substring(pos + 1);
      value = value.replace(/\+/g, " ");
      args[argname] = value;
    }
  }
  return args;
}


</script>
</head>
<style>
#callToAction {
}
#approvedVideos {
	height: 450px;
	overflow: auto;
	border: 0px solid black;
}
</style>
<body>
<div align="center">
<div align="center" style="width: 900px;">

<table cellpadding="5" cellspacing="5">
	<tr valign="top">
		<td>
		<h3>Hubble image shows debris from Jupiter collision</h3>
		<p style="font-size: 12px; font-family: arial;"><img src="jupiter.jpg"/>
		BALTIMORE - NASA's
		Hubble Space Telescope is offering a glimpse of atmospheric debris
		from an object that plunged into Jupiter in a rare collision with the
		planet. Scientists used the telescope Thursday to capture what they
		call the "sharpest visible-light picture" so far of the expanding
		gash. An amateur stargazer in Australia spotted the impression last
		Sunday. Amy Simon-Miller of NASA's Goddard Space Flight Center in
		Greenbelt, Md., says the magnitude of the impact is believed to be
		rare. Simon-Miller estimates the diameter of the object that hit the
		planet was the size of several football fields. The debris possibly
		came from a comet or asteroid that hit Jupiter. NASA also says the new
		images prove repairs done on the Hubble in May were successful.</p>
		</td>
		<td align="center">
		<br><br>
		
		<a id="callToAction" href="javascript:void(0);"><img src="calltoaction.png" border="0"/></a>
		<div id="ytd"></div>
		<div id="approvedVideos"></div>
		
		</td>
	</tr>
</table>

</div>
</div>
</body>
</html>
